(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{806:function(t,e,n){Promise.resolve().then(n.bind(n,7934))},7138:function(t,e,n){"use strict";n.d(e,{default:function(){return a.a}});var r=n(231),a=n.n(r)},6463:function(t,e,n){"use strict";var r=n(1169);n.o(r,"useRouter")&&n.d(e,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(e,{useSearchParams:function(){return r.useSearchParams}})},7934:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var r=n(7437),a=n(2265),o=n(7138),i=n(6463),s=n(5686),c=n(1180);function l(){let t=(0,i.useRouter)(),[e,n]=(0,a.useState)(""),[l,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)([]),[m,f]=(0,a.useState)(1),[p,b]=(0,a.useState)(1),[g,w]=(0,a.useState)(""),[x,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(""),[S,N]=(0,a.useState)(""),k=(0,a.useCallback)(async t=>{y(!0),j("");try{let e=await (0,c.Uw)(t,{page:m,limit:20,q:g});h(e.items),b(e.totalPages)}catch(t){j("Unable to load subscribers.")}finally{y(!1)}},[m,g]);async function E(t,n){j(""),N("");try{await (0,c.Mk)(e,t,n),N("Subscriber updated."),await k(e)}catch(t){j("Unable to update subscriber.")}}return(0,a.useEffect)(()=>{let e=(0,s.v0)();if(!e||"admin"!==e.user.role){t.replace("/blog/admin/auth");return}u(!0),n(e.accessToken),k(e.accessToken)},[k,t]),(0,a.useEffect)(()=>{e&&k(e)},[k,e,m,g]),l?(0,r.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-slate-900 via-slate-800 to-black pt-24",children:(0,r.jsxs)("section",{className:"mx-auto max-w-7xl px-6 pb-16",children:[(0,r.jsxs)("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white sm:text-3xl",children:"Subscribers"}),(0,r.jsxs)("div",{className:"grid w-full grid-cols-2 gap-2 sm:flex sm:w-auto sm:gap-2",children:[(0,r.jsx)(o.default,{href:"/blog/admin/posts",className:"rounded-full border border-white/25 px-4 py-2 text-center text-sm font-semibold text-white transition hover:bg-white/10",children:"Back to Admin"}),(0,r.jsx)("button",{type:"button",onClick:function(){(0,s.DH)(),t.replace("/blog/admin/auth")},className:"rounded-full border border-rose-400/35 px-4 py-2 text-sm font-semibold text-rose-200 transition hover:bg-rose-500/10",children:"Logout"})]})]}),(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,r.jsxs)("div",{className:"mb-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white sm:text-xl",children:"Email Subscribers"}),(0,r.jsx)("input",{value:g,onChange:t=>{f(1),w(t.target.value)},placeholder:"Search email...",className:"w-full rounded-lg border border-white/20 bg-black/40 px-3 py-2 text-sm text-white outline-none sm:w-64"})]}),x?(0,r.jsx)("p",{className:"text-sm text-gray-300",children:"Loading..."}):0===d.length?(0,r.jsx)("p",{className:"text-sm text-gray-300",children:"No subscribers found."}):(0,r.jsx)("div",{className:"space-y-3",children:d.map(t=>(0,r.jsxs)("div",{className:"rounded-xl border border-white/10 bg-black/20 p-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-white",children:t.email}),(0,r.jsx)("span",{className:"text-xs text-gray-300",children:function(t){let e=new Date(t);return Number.isNaN(e.getTime())?"-":e.toLocaleDateString("en-PK",{year:"numeric",month:"short",day:"numeric"})}(t.createdAt)})]}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-gray-300",children:["Source: ",t.source]}),(0,r.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:(0,r.jsx)("button",{type:"button",onClick:()=>void E(t.id,!t.isActive),className:"rounded-full px-3 py-1 text-xs font-semibold ".concat(t.isActive?"bg-emerald-500/20 text-emerald-200":"bg-rose-500/20 text-rose-200"),children:t.isActive?"Active (Click to Deactivate)":"Inactive (Click to Activate)"})})]},t.id))}),!x&&p>1&&(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>f(t=>Math.max(1,t-1)),disabled:m<=1,className:"rounded-full border border-white/20 px-3 py-1 text-xs font-semibold text-white transition hover:bg-white/10 disabled:opacity-40",children:"Previous"}),(0,r.jsxs)("span",{className:"rounded-full border border-white/20 px-3 py-1 text-xs font-semibold text-gray-200",children:["Page ",m," of ",p]}),(0,r.jsx)("button",{type:"button",onClick:()=>f(t=>Math.min(p,t+1)),disabled:m>=p,className:"rounded-full border border-white/20 px-3 py-1 text-xs font-semibold text-white transition hover:bg-white/10 disabled:opacity-40",children:"Next"})]})]}),v&&(0,r.jsx)("p",{className:"mt-4 rounded-lg bg-rose-500/15 px-4 py-3 text-sm text-rose-200",children:v}),S&&(0,r.jsx)("p",{className:"mt-4 rounded-lg bg-emerald-500/15 px-4 py-3 text-sm text-emerald-200",children:S})]})}):(0,r.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-slate-900 via-slate-800 to-black pt-24",children:(0,r.jsx)("section",{className:"mx-auto max-w-3xl px-6 pb-16",children:(0,r.jsx)("div",{className:"mt-6 rounded-2xl border border-amber-400/30 bg-amber-500/10 p-5 text-amber-100",children:(0,r.jsx)("p",{className:"text-sm",children:"Checking admin access..."})})})})}},1180:function(t,e,n){"use strict";var r;n.d(e,{BC:function(){return k},Cw:function(){return f},Dj:function(){return p},JQ:function(){return o},Mk:function(){return N},OW:function(){return c},QP:function(){return E},T:function(){return u},T6:function(){return i},TO:function(){return x},Uw:function(){return S},X2:function(){return d},dd:function(){return w},h9:function(){return b},jk:function(){return j},jw:function(){return h},lL:function(){return l},nf:function(){return m},rX:function(){return s},s9:function(){return g},uE:function(){return y},w6:function(){return v}});let a=null!==(r="http://localhost:5000".replace(/\/$/,""))&&void 0!==r?r:"http://localhost:5000";function o(){return a}async function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"no-store",o=new URLSearchParams({page:String(t),limit:String(e)});n.trim()&&o.set("q",n.trim());let i=await fetch("".concat(a,"/posts?").concat(o.toString()),{method:"GET",cache:r});if(!i.ok)throw Error("Unable to fetch posts");let s=await i.json();return Array.isArray(s)?{items:s,total:s.length,page:1,limit:e,totalPages:1}:s}async function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=await fetch("".concat(a,"/posts/admin/all?limit=").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(!n.ok)throw Error("Unable to fetch admin posts");return await n.json()}async function c(t,e){let n=await fetch("".concat(a,"/posts/admin/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(!n.ok)throw Error("Unable to fetch post");return await n.json()}async function l(t,e){let n=new FormData;n.append("file",e);let r=await fetch("".concat(a,"/posts/admin/upload-image"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:n});if(!r.ok)throw Error("Image upload failed");let o=await r.json();if(!o.url)throw Error("No image URL returned from server");return o.url}async function u(t,e){let n=new FormData;n.append("file",e);let r=await fetch("".concat(a,"/student-articles/upload-image"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:n});if(!r.ok)throw Error("Image upload failed");let o=await r.json();if(!o.url)throw Error("No image URL returned from server");return o.url}async function d(t){let{token:e,...n}=t,r=await fetch("".concat(a,"/student-articles"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(n)});if(!r.ok){var o;throw Error(null!==(o=(await r.json()).message)&&void 0!==o?o:"Article submission failed")}return r.json()}async function h(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=new URLSearchParams({page:String(t),limit:String(e)});n.trim()&&r.set("q",n.trim());let o=await fetch("".concat(a,"/student-articles?").concat(r.toString()),{method:"GET",cache:"no-store"});if(!o.ok)throw Error("Unable to fetch student articles");return await o.json()}async function m(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams;n.status&&r.set("status",n.status),n.page&&r.set("page",String(n.page)),n.limit&&r.set("limit",String(n.limit)),(null===(e=n.q)||void 0===e?void 0:e.trim())&&r.set("q",n.q.trim());let o=await fetch("".concat(a,"/student-articles/admin/all?").concat(r.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(!o.ok)throw Error("Unable to fetch student articles");return await o.json()}async function f(t,e,n){let r=await fetch("".concat(a,"/student-articles/admin/").concat(e,"/approve"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(null!=n?n:{})});if(!r.ok)throw Error("Unable to approve article");return r.json()}async function p(t,e){let n=await fetch("".concat(a,"/student-articles/admin/").concat(e,"/reject"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t)}});if(!n.ok)throw Error("Unable to reject article");return n.json()}async function b(t){let e=new FormData;e.append("file",t);let n=await fetch("".concat(a,"/tutor-applications/upload-resume"),{method:"POST",body:e});if(!n.ok)throw Error("Resume upload failed");let r=await n.json();if(!r.url)throw Error("No resume URL returned from server");return r.url}async function g(t){let e=await fetch("".concat(a,"/tutor-applications"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){var n;throw Error(null!==(n=(await e.json()).message)&&void 0!==n?n:"Tutor application failed")}return e.json()}async function w(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams;n.status&&r.set("status",n.status),n.page&&r.set("page",String(n.page)),n.limit&&r.set("limit",String(n.limit)),(null===(e=n.q)||void 0===e?void 0:e.trim())&&r.set("q",n.q.trim());let o=await fetch("".concat(a,"/tutor-applications/admin/all?").concat(r.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(!o.ok)throw Error("Unable to fetch tutor applications");return await o.json()}async function x(t,e,n){let r=await fetch("".concat(a,"/tutor-applications/admin/").concat(e,"/status"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw Error("Unable to update tutor application");return r.json()}async function y(t){let e=await fetch("".concat(a,"/subscribers/email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){var n;throw Error(null!==(n=(await e.json()).message)&&void 0!==n?n:"Subscriber signup failed")}return e.json()}async function v(){let t=await fetch("".concat(a,"/subscribers/push-public-key"),{method:"GET",cache:"no-store"});if(!t.ok)throw Error("Unable to fetch push public key");return t.json()}async function j(t){let e=await fetch("".concat(a,"/subscribers/push"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){var n;throw Error(null!==(n=(await e.json()).message)&&void 0!==n?n:"Push subscription failed")}return e.json()}async function S(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams;n.page&&r.set("page",String(n.page)),n.limit&&r.set("limit",String(n.limit)),(null===(e=n.q)||void 0===e?void 0:e.trim())&&r.set("q",n.q.trim());let o=await fetch("".concat(a,"/subscribers/admin/email?").concat(r.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(t)},cache:"no-store"});if(!o.ok)throw Error("Unable to fetch subscribers");return o.json()}async function N(t,e,n){let r=await fetch("".concat(a,"/subscribers/admin/email/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({isActive:n})});if(!r.ok)throw Error("Unable to update subscriber");return r.json()}async function k(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=new URLSearchParams({page:String(e),limit:String(n)}),o=await fetch("".concat(a,"/comments/post/").concat(encodeURIComponent(t),"?").concat(r.toString()),{method:"GET",cache:"no-store"});if(!o.ok)throw Error("Unable to fetch comments");return o.json()}async function E(t,e,n){let r=await fetch("".concat(a,"/comments/post/").concat(encodeURIComponent(e)),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({content:n})});if(!r.ok){var o;throw Error(null!==(o=(await r.json()).message)&&void 0!==o?o:"Unable to post comment")}return r.json()}},5686:function(t,e,n){"use strict";n.d(e,{DH:function(){return s},Gi:function(){return a},J1:function(){return o},v0:function(){return i}});let r="blog_admin_auth",a="blog-auth-changed";function o(t){localStorage.setItem(r,JSON.stringify(t)),window.dispatchEvent(new Event(a))}function i(){let t=localStorage.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch(t){return null}}function s(){localStorage.removeItem(r),window.dispatchEvent(new Event(a))}}},function(t){t.O(0,[231,971,23,744],function(){return t(t.s=806)}),_N_E=t.O()}]);